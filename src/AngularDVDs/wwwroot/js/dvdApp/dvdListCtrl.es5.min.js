"use strict";(function(){function n(n,t,i,r,u){function f(){u.spin("dvdSpinner")}function e(){u.stop("dvdSpinner")}function o(i){t.post("api/dvds",i).then(function(t){var f=t.statusCode,u;console.log("dvd post action succeded: "+f);r.showToast("success",3e3,i.DVD_TITLE+" successfully added to database.");u=t.data.DVD_ID;i.DVD_ID=u;n.dvds.push(i)},function(t){console.log("DVD Post action failed: "+t.statusCode);r.showToast("error",3e3,"Addition of "+i.DVD_TITLE+" failed.");var u=n.dvds.indexOf(i);n.slice(u,1)})}var s=this;n.dvds=[];n.directors=[];n.genres=[];n.dvdSearch="";n.addMode=!1;n.orderColumn="-DVD_ADDMOD_Datetime";n.orderTableBy=function(t){switch(n.orderColumn){case t:n.orderColumn="-"+t;break;default:n.orderColumn=t}};n.enableAddMode=function(i){t.get("api/directors").then(function(t){n.directors=t.data});t.get("api/genres").then(function(t){n.genres=t.data});n.addMode=i};n.jsonDebugging="";n.dvdToAdd={DVD_TITLE:"",DVD_DIRECTOR_ID:"",DVD_GENRE_ID:"",DVD_RELEASE_YEAR:(new Date).getFullYear(),DVD_ADDMOD_Datetime:new Date};n.spinnerActive=!1;n.refreshData=function(i){f();n.dvds=[];setTimeout(function(){t.get("api/directors").then(function(t){n.directors=t.data})},500);setTimeout(function(){t.get("api/genres").then(function(t){n.genres=t.data})},500);setTimeout(function(){t.get("api/dvds").then(function(t){n.dvds=t.data;setTimeout(function(){e()},300)})},500);n.dvdSearch="";i!==!1&&r.showToast("info",3e3,"DVD Data Refreshed")};n.refreshData(!1);n.removeDVD=function(i){t["delete"]("api/dvds/"+i).then(function(){r.showToast("success",3e3,"DVD removed from database")},function(n){r.showToast("error",3e3,"DVD couldn't be removed: Code: "+n.statusCode)});for(var u=0;u<n.dvds.length;u++)n.dvds[u].DVD_ID===i&&n.dvds.splice(u,1)};n.dvdsIsEmpty=function(){return n.dvds.length===0?!0:!1};n.addDVD=function(){var n=angular.element("<tr id='addDvdRow' add-dvd-inline><\/tr>");i(n);$("#AddDvdRow").replaceWith(n)};n.saveDVD=function(){if(n.dvdToAdd.DVD_GENRE_ID===""&&$("#genreIdSelect").popover({placement:"bottom"}).popover("show"),n.dvdToAdd.DVD_DIRECTOR_ID===""&&$("#directorIdSelect").popover({placement:"top"}).popover("show"),n.dvdToAdd.DVD_DIRECTOR_ID!==""&&n.dvdToAdd.DVD_GENRE_ID!==""){var t=n.dvdToAdd;n.dvdToAdd={DVD_TITLE:"",DVD_DIRECTOR_ID:"",DVD_GENRE_ID:"",DVD_RELEASE_YEAR:(new Date).getFullYear(),DVD_ADDMOD_Datetime:new Date};r.showToast("info",3e3,t.DVD_TITLE+" added to list.");o(t);n.enableAddMode(!1)}};n.getJson=function(n){return angular.fromJson(n)}}function t(){return{templateUrl:"templates/AddDvdInline",restrict:"AE",replace:!0,scope:!0,link:function(){}}}angular.module("dvdApp").directive("addDvdInline",t).controller("dvdListCtrl",n);n.$inject=["$scope","$http","$compile","toastFactory","usSpinnerService"]})(window);