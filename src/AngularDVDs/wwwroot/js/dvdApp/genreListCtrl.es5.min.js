"use strict";(function(){function t(){return{templateUrl:"templates/addGenreModal",restrict:"AE",replace:!0,scope:!0,link:function(){}}}function n(n,t,i,r){function f(){r.spin("genSpinner")}function e(){r.stop("genSpinner")}function o(){t.get("api/genres").then(function(t){n.genres=u(t.data)})}function u(n){return n.sort(function(n,t){return n.DIRECTOR_ADDMOD_Datetime>=t.GENRE_ADDMOD_Datetime?n.GENRE_ADDMOD_Datetime>t.GENRE_ADDMOD_Datetime?-1:0:1})}n.title="genreListCtrl";n.genres=[];n.genresIsEmpty=function(){return n.genres.length===0};n.addGenre=function(r,u){u===undefined&&(u=" ");for(var f=0;f<n.genres.length;f++)if(n.genres[f].GENRE_NAME.toLowerCase()===r.toLowerCase()){i.showToast("error",3e3,"Genre alredy exists in database");$("#newGenreNameInput").popover({placement:"top"}).popover("show");return}t.post("api/genres",{GENRE_NAME:r,GENRE_DESC:u}).then(function(){i.showToast("success",3e3,"Genre added to database");$("#addGenreModal").modal("hide");n.refreshGenres()},function(){i.showToast("error",3e3,"Genre could not be added to database")})};o();n.refreshGenres=function(){f();n.genres=[];setTimeout(function(){t.get("api/genres").then(function(t){n.genres=u(t.data);setTimeout(function(){e()},300)})},500);i.showToast("info",3e3,"Genres refreshed.")}}angular.module("dvdApp").directive("addGenreModal",t).controller("genreListCtrl",n);n.$inject=["$scope","$http","toastFactory","usSpinnerService"]})();